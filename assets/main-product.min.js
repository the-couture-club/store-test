const productRecommendationsSection = document.querySelector(
    ".product-recommendations"
  ),
  productRecommendationsSectionArray = document.querySelectorAll(
    ".product-recommendations"
  ),
  url = productRecommendationsSection.dataset.url;
var e;
fetch(url)
  .then((e) => e.text())
  .then((e) => {
    const t = document.createElement("div");
    t.innerHTML = e;
    const r = t.querySelector(".product-recommendations");
    r &&
      r.innerHTML.trim().length &&
      productRecommendationsSectionArray.forEach((e) => {
        e.innerHTML = r.innerHTML;
      });
  })
  .then((e) => {
    const t = document.querySelectorAll(
      '.product-recommendations form[action^="/cart/add"]:not(.initialised)'
    );
    Array.from(t).forEach((e) => window.ajaxCart.initForm(e)),
      Array.from(t).forEach((e) => e.classList.add("initialised")),
      upsellFormsInit(),
      productUpsellsGA();
  })
  .catch((e) => {}),
  window.addEventListener(
    "load",
    function (e) {
      document.querySelector("html").classList.add("no-scroll"),
        document.querySelector("body").setAttribute("data-product-page", ""),
        sizeGuideInit(),
        setTimeout(function () {
          checkBIS();
        }, 1e3);
    },
    !0
  ),
  document
    .querySelector(".product_container--toggle")
    .addEventListener("click", function (e) {
      $("html,body").animate({
        scrollTop: $(".product_container__content-header").offset().top - 100,
      });
    }),
  (e = document.getElementById("product-form__select")).addEventListener(
    "change",
    function () {
      document.querySelector(
        '.product_container__content-header--form [name="id"]'
      ).value = this.value;
      var e = document
          .querySelector("#product-form__select")
          .getAttribute("data-launch"),
        t = document
          .querySelector('option[value="' + this.value + '"]')
          .getAttribute("data-preorder"),
        r = document
          .querySelector('option[value="' + this.value + '"]')
          .getAttribute("data-stock");
      if ("true" == e)
        document
          .querySelector(".product_container__content-header--form_submit")
          .setAttribute("data-stock", "launch"),
          document
            .querySelector(
              '.product_container__content-header--form [name="properties[_is_pre_order]"]'
            )
            .setAttribute("disabled", "true"),
          document
            .querySelector(
              '.product_container__content-header--form [name="properties[_pre_order]"]'
            )
            .setAttribute("value", "*");
      else if ("true" == t) {
        document
          .querySelector(".product_container__content-header--form_submit")
          .setAttribute("data-stock", "preorder"),
          document
            .querySelector(
              '.product_container__content-header--form [name="properties[_is_pre_order]"]'
            )
            .removeAttribute("disabled");
        var o = document
          .querySelector(
            '.product_container__content-header--form [name="properties[_pre_order]"]'
          )
          .getAttribute("data-date");
        document.querySelector(
          '.product_container__content-header--form [name="properties[_pre_order]"]'
        ).value = 'true';
      } else
        lastItems(r),
          document
            .querySelector(".product_container__content-header--form_submit")
            .setAttribute("data-stock", r),
          document
            .querySelector(
              '.product_container__content-header--form [name="properties[_is_pre_order]"]'
            )
            .setAttribute("disabled", "true"),
          document
            .querySelector(
              '.product_container__content-header--form [name="properties[_pre_order]"]'
            )
            .setAttribute("value", "*");
      let n = new URL(window.location.href);
      n.searchParams.set("variant", this.value),
        history.pushState("", document.title, n.href);
    }
  ),
  (e = document.querySelector(
    ".product-form__select-overlay"
  )).addEventListener("click", function (e) {
    document.querySelector(".js-product-size-trigger").click();
  }),
  (e = document.querySelector(".product-size-close")).addEventListener(
    "click",
    function (e) {
      document
        .querySelector(".product-size__wrapper .quick-shop__close")
        .click();
    }
  );
var gridButtons = document.querySelectorAll(
  " .product-size__wrapper product-interactive-options input"
);
gridButtons.forEach((e) => {
  e.addEventListener("click", function () {
    var e = document.querySelector(
      '#product-form__select [title="' + this.value + '"]'
    );
    (document.querySelector("#product-form__select").value = e.value),
      (document.querySelector('[name="id"]').value = e.value);
    var t = document
        .querySelector("#product-form__select")
        .getAttribute("data-launch"),
      r = e.getAttribute("data-preorder"),
      o = document
        .querySelector('option[title="' + this.value + '"]')
        .getAttribute("data-stock");
    if ("true" == t)
      document
        .querySelector(".product_container__content-header--form_submit")
        .setAttribute("data-stock", "launch"),
        document
          .querySelector(
            '.product_container__content-header--form [name="properties[_is_pre_order]"]'
          )
          .setAttribute("disabled", "true"),
        document
          .querySelector(
            '.product_container__content-header--form [name="properties[_pre_order]"]'
          )
          .setAttribute("value", "*");
    else if ("true" == r) {
      document
        .querySelector(".product_container__content-header--form_submit")
        .setAttribute("data-stock", "preorder"),
        document
          .querySelector(
            '.product_container__content-header--form [name="properties[_is_pre_order]"]'
          )
          .removeAttribute("disabled");
      var n = document
        .querySelector(
          '.product_container__content-header--form [name="properties[_pre_order]"]'
        )
        .getAttribute("data-date");
      document.querySelector(
        '.product_container__content-header--form [name="properties[_pre_order]"]'
      ).value = 'true';
    } else
      lastItems(o),
        document
          .querySelector(".product_container__content-header--form_submit")
          .setAttribute("data-stock", o),
        document
          .querySelector(
            '.product_container__content-header--form [name="properties[_is_pre_order]"]'
          )
          .setAttribute("disabled", "true"),
        document
          .querySelector(
            '.product_container__content-header--form [name="properties[_pre_order]"]'
          )
          .setAttribute("value", "*");
    let c = new URL(window.location.href);
    c.searchParams.set("variant", e.value),
      history.pushState("", document.title, c.href),
      setTimeout(() => {
        document
          .querySelector(".product-size__wrapper .quick-shop__close")
          .click();
      }, 100);
  });
});
var btn = document.querySelectorAll(".js-product-notify");
btn.forEach((e) => {
  e.addEventListener("click", function () {
    var e = document.getElementById("product-form__select").value;
    theme.mfpOpen("bis-popup"),
      (document.getElementById("bis-select").value = e),
      document.querySelector('#bis [name="id"]').setAttribute("value", e),
      document
        .querySelector("#bis .js-product-add")
        .removeAttribute("disabled");
  });
});
var atcButtons = document.querySelectorAll(
  ".product_container__content-header--form .js-product-add"
);
function upsellFormsInit() {
  document.querySelectorAll(".js-upsell-form").forEach((e) => {
    e.addEventListener("change", function () {
      (e.querySelector('[name="id"]').value = e.querySelector(
        "#product-form__select"
      ).value),
        e.querySelector('[type="submit"]').click();
    });
  });
}
function lastItems(e) {
  var t = document.querySelector(".last_stock");
  (t.innerHTML = ""),
    1 == e
      ? (t.removeAttribute("hidden"),
        t.setAttribute("stock", "last-stock"),
        (t.innerHTML =
          '<div class="ring-container"><div class="ringring"></div><div class="circle"></div></div><span>' +
          e +
          " Unit Left</span>"))
      : e <= theme.custom.units_left.red && e > 0
      ? (t.removeAttribute("hidden"),
        t.setAttribute("stock", "last-stock"),
        (t.innerHTML =
          '<div class="ring-container"><div class="ringring"></div><div class="circle"></div></div><span>' +
          e +
          " Units Left</span>"))
      : e <= theme.custom.units_left.orange && e > 0
      ? (t.removeAttribute("hidden"),
        t.setAttribute("stock", "low-stock"),
        (t.innerHTML =
          '<div class="ring-container"><div class="ringring"></div><div class="circle"></div></div><span>' +
          e +
          " Units Left</span>"))
      : e > 0 &&
        (t.setAttribute("stock", "in-stock"),
        (t.innerHTML =
          '<div class="ring-container"><div class="ringring"></div><div class="circle"></div></div><span>In-Stock</span>'));
}
function checkBIS() {
  var e = new URL(window.location.href);
  e.searchParams.has("bis") &&
    (theme.mfpOpen("bis-popup"),
    (document.querySelector(
      '.mfp-content .quick-shop-bis #bis-select [value="' +
        e.searchParams.get("bis") +
        '"]'
    ).selected = !0),
    document
      .querySelector('.mfp-content .quick-shop-bis [name="id"]')
      .setAttribute("value", e.searchParams.get("bis")),
    document
      .querySelector(".mfp-content .js-product-add")
      .removeAttribute("disabled"));
}
atcButtons.forEach((e) => {
  e.addEventListener("click", (t) => {
    "" == e.parentElement.getAttribute("data-stock") &&
      (t.preventDefault(),
      document.querySelector("body").scrollTo({ top: 0, behavior: "smooth" }),
      e.classList.add("error"),
      e.classList.add("animate"),
      setTimeout(function () {
        e.classList.remove("animate");
      }, 1e3));
  });
});
var element = document.querySelector(
  ".product_container__content-header--form_submit"
);
document.querySelector("body").addEventListener(
  "scroll",
  function (e) {
    isInViewport(element)
      ? document.querySelector("html").classList.remove("cta-out-of-view")
      : document.querySelector("html").classList.add("cta-out-of-view");
  },
  !1
);
